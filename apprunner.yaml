version: 1.0
runtime: python311
build:
  env:
  #    - name: DATABASE_HOST
  #      value: "django-psql-db-integration.csfkk1qfrwcy.us-east-2.rds.amazonaws.com"
  #    - name: DATABASE_PASS
  #      value: "2qZVgxQgQN6a7pKw37KY6MNF84RGTipQ"
  #    - name: DATABASE_USER
  #      value: "GycjCWhKDwraNKV3"
  #    - name: DJANGO_SECRET_KEY
  #      value: "django-insecure-e_8rwh&ywsji&zh=vb9rmd4z0%a!%u(zlge_%g5r^&p49euq%$"
  #    - name: DJANGO_SETTINGS_MODULE
  #      value: "mysite.settings"
  commands:
    pre-build:
    #      - python3 env_test.py python3prebuild
    build:
      #      - python3 env_test.py python3buildbeforepipenv
      - pip3 install --upgrade pip
      - pip3 install pipenv
      - pipenv install
    #      - pipenv run python3 env_test.py pipenvbuild
    #      - python3 env_test.py python3buildafterpipenv
    post-build:
    #      - python3 env_test.py python3postbuild
    #      - pipenv run python3 env_test.py pipenvpostbuild
    #      - pipenv run python3 env_test.py
#      - pipenv run python3 manage.py test
run:
  runtime-version: 3.11
  pre-run:
    #    - python3 env_test.py python3prerunbeforepipenv
    - pip3 install --upgrade pip
    - pip3 install pipenv
    - pipenv install
    #    - pipenv run python3 env_test.py pipenvprerun
    #    - python3 env_test.py python3prerunafterpipenv
    - pipenv run python3 manage.py test

  command: pipenv run gunicorn mysite.wsgi --log-file -
  env:
    - name: DATABASE_HOST
      value: "django-psql-db-integration.csfkk1qfrwcy.us-east-2.rds.amazonaws.com"
    - name: DATABASE_PASS
      value: "2qZVgxQgQN6a7pKw37KY6MNF84RGTipQ"
    - name: DATABASE_USER
      value: "GycjCWhKDwraNKV3"
    - name: DJANGO_SECRET_KEY
      value: "django-insecure-e_8rwh&ywsji&zh=vb9rmd4z0%a!%u(zlge_%g5r^&p49euq%$"
    - name: DJANGO_SETTINGS_MODULE
      value: "mysite.settings"
  network:
    port: 8000
