version: 1.0
runtime: python311
build:
  commands:
    build:
      - pip3 install -r requirements.txt
    post-build:
      - python3 manage.py makemigrations
      - python3 manage.py migrate
      - python3 manage.py collectstatic
      - python3 manage.py test
      - python3 manage.py createsuperuser
  env:
    - name: DATABASE_HOST
      value: "django-psql-db-integration.csfkk1qfrwcy.us-east-2.rds.amazonaws.com"
    - name: DATABASE_PASS
      value: "2qZVgxQgQN6a7pKw37KY6MNF84RGTipQ"
    - name: DATABASE_USER
      value: "GycjCWhKDwraNKV3"
    - name: DJANGO_SECRET_KEY
      value: "django-insecure-e_8rwh&ywsji&zh=vb9rmd4z0%a!%u(zlge_%g5r^&p49euq%$"
    - name: DJANGO_SETTINGS_MODULE
      value: "mysite.settings"
run:
  runtime-version: 3.11
  command: pipenv run gunicorn mysite.wsgi --log-file -
  network:
    port: 8000
